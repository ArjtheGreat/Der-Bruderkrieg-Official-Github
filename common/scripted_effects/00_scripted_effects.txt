#	Example:
# 
#	example_effect = {
#		add_political_power = 66
#		add_popularity = {
#			ideology = fascism
#			popularity = 0.33
#		}
#	}
#
#
#	In a script file:
#
#	effect = {
#		example_effect = yes
#	}
#

#####################################
### emergency_factory_conversion ####
#####################################

#This is going to give misleading and ugly tooltips. Making it nice will take effort. TODO_WTT_CD make nice or ignore and remove comment. Easiest solution is just making a custom tooltip that says "5 civilian factories will be converted to military factories" and ignore telling the player the states where it will happen.
d_decrease_opinion = {
	GLC = {
		add_opinion_modifier = {
			target = GER
			modifier = large_decrease
		}
	}
}
d_russo_austro_japanese_war = {
	SOV = {
		declare_war_on = {
			target = AUS
			type = topple_government
		}
		declare_war_on = {
			target = JAP
			type = topple_government
		}
	}
}
d_faction_leader = {
	log = "Faction Leader: [?ROOT.faction_leader.GetName]"
}
d_change_faction_behavior = {
	add_to_variable = {
		behavior_garrison = 1
	}
}
d_reset_faction_behavior = {
	set_variable = {
		behavior_garrison = 0
	}
}
d_drop_cosmetic_tag = {
	drop_cosmetic_tag = yes
}
d_fire_russian_intervention = {
	SOV = {
		country_event = russian_inteverntion_in_europakrieg.2
	}
}
d_has_global_flag_wiltkrieg = {
	if = {
		limit = {
			has_global_flag = wiltkrieg
		}
		log = "has_global_flag = wiltkrieg"
	}
}
d_brazil_test = {
	if = {
		limit = {
			BRE = {
				has_idea = brazil_nerf
			}
		}
		log = "BRE has nerf"
	}
	if = {
		limit = {
			SRB = {
				has_idea = brazil_nerf
			}
		}
		log = "SRB has nerf"
	}
	if = {
		limit = {
			BRS = {
				has_idea = brazil_nerf
			}
		}
		log = "BRS has nerf"
	}
	if = {
		limit = {
			UBR = {
				has_idea = brazil_nerf
			}
		}
		log = "UBR has nerf"
	}
}
d_continent_check = {
	log = "hi"
	if = {
		limit = {
			capital_scope = {
				is_on_continent = south_america
			}
			
		}
		log = "fuck this game"
	}
}
spheres_of_influence_setup = {
	every_country = {
		if = {
			limit = {
				check_variable = {
					influence_variable = 1
				}
			}
			keep_current_politics = yes
			FRA = {
				set_autonomy = {
					target = PREV
					autonomous_state = autonomy_influenced_state
				}
			}
			reset_government = yes
			leave_faction = yes
		}
		else_if = {
			limit = {
				check_variable = {
					influence_variable = 2
				}
			}
			keep_current_politics = yes
			AUS = {
				set_autonomy = {
					target = PREV
					autonomous_state = autonomy_influenced_state
				}
			}
			reset_government = yes
			leave_faction = yes
		}
		else_if = {
			limit = {
				check_variable = {
					influence_variable = 3
				}
			}
			keep_current_politics = yes
			SOV = {
				set_autonomy = {
					target = PREV
					autonomous_state = autonomy_influenced_state
				}
			}
			reset_government = yes
			leave_faction = yes
		}
		else_if = {
			limit = {
				check_variable = {
					influence_variable = 4
				}
			}
			keep_current_politics = yes
			ENG = {
				set_autonomy = {
					target = PREV
					autonomous_state = autonomy_influenced_state
				}
			}
			reset_government = yes
			leave_faction = yes
		}
		else_if = {
			limit = {
				check_variable = {
					influence_variable = 5
				}
			}
			keep_current_politics = yes
			USA = {
				set_autonomy = {
					target = PREV
					autonomous_state = autonomy_influenced_state
				}
			}
			reset_government = yes
			leave_faction = yes
		}
		else_if = {
			limit = {
				check_variable = {
					influence_variable = 6
				}
			}
			keep_current_politics = yes
			GER = {
				set_autonomy = {
					target = PREV
					autonomous_state = autonomy_influenced_state
				}
			}
			reset_government = yes
			leave_faction = yes
		}
	}
}
d_head_of_gov_setup = {
	head_of_gov_setup = yes
	if = {
		limit = {
			capital_scope = {
				region = 196
			}
		}
		log = "phil"
	}
} 
head_of_gov_setup = {
	if = {
		limit = {
			capital_scope = { is_on_continent = africa }
		}
		
		random_list = {
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_8_flag
			}
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_6_flag
			# }
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_1_flag
			# }
			1 = {
			set_country_flag =Portrait_Africa_Generic_navy_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_8_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_navy_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_5_flag
			}
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_4_flag
			# }
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_2_flag
			# }
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_7_flag
			# }
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_navy_new_3_flag
			}
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_3_flag
			# }
			1 = {
			set_country_flag =Portrait_Africa_Generic_navy_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_land_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Africa_Generic_new_1_flag
			}
			# 1 = {
			# set_country_flag =Portrait_German_Africa_Generic_land_5_flag
			# }

		}
	}
	if = {
		limit = {
			capital_scope = { is_on_continent = europe }
		}
		random_list = { 
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_1_flag
			log = "iwqji"
			}
			1 = { 
			set_country_flag =Portrait_Europe_Generic_new_16_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_14_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_17_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_navy_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_10_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_navy_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_13_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_8_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_8_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_9_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_15_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_12_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_navy_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_11_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_navy_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_10_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_navy_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_land_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_Europe_Generic_new_9_flag
			}

		}
	}
	if = {
		limit = {
			capital_scope = { is_on_continent = south_america }
		}
		random_list = {
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_3_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_navy_new_2_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_4_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_2_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_1_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_navy_new_3_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_6_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_8_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_7_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_navy_new_1_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_1_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_6_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_3_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_5_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_2_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_5_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_land_new_7_flag
		}
		1 = {
		set_country_flag =Portrait_South_America_Generic_new_4_flag
		}
		}
	}
	if = {
		limit = {
			capital_scope = { is_on_continent = north_america }
		}
		random_list = {
		1 = {
		set_country_flag =Portrait_America_Generic_land_2_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_land_5_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_land_4_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_land_3_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_navy_4_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_navy_3_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_navy_1_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_land_1_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_navy_2_flag
		}
		1 = {
		set_country_flag =Portrait_America_Generic_land_6_flag
		}
	}

	}
	if = {
		limit = {
			capital_scope = { is_on_continent = asia }
		}
		log = "arabia1"
		
		if = {
			limit = {
				capital_scope = {
					OR = {
						region = 162
						region = 190
						region = 153
						region = 31
						region = 141
					}
				}
			}
			random_list = {
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_9_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_8_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_navy_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_navy_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_navy_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_navy_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_navy_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_land_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_India_Generic_new_2_flag
			}
		}

		}
		else = {
			random_list = {
		
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_8_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_land_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_land_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_navy_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_navy_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_navy_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_navy_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_land_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_land_new_6_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_new_1_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_new_3_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_land_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_land_new_7_flag
			}
			1 = {
			set_country_flag =Portrait_Asia_Generic_navy_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_land_new_2_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_new_4_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_new_5_flag
			}
			1 = {
			set_country_flag =Portrait_Central_Asia_Generic_new_6_flag
			}
			}
		}

	}
	if = {
			limit = {
				capital_scope = {
					OR = {
						region = 129
						region = 28
						region = 196
						region = 100
						region = 116
					}
				}
			}
			log = "arabia"
			random_list = {
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_2_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_land_new_3_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_7_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_land_new_2_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_4_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_3_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_land_new_4_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_5_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_land_new_1_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_navy_new_2_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_land_new_6_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_navy_new_1_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_6_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_1_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_land_new_5_flag
				}
				1 = {
				set_country_flag =Portrait_Arabia_Generic_new_8_flag
				}
			}

			

		}
}
d_check_thing = {
	spheres_of_influence_setup = yes
}
# SCRIPTED EFFECT
keep_current_politics = {
	log = "[THIS.GetName]"
	set_variable = { save_democratic = party_popularity@democratic }
	set_variable = { save_fascism = party_popularity@fascism }
	set_variable = { save_neutrality = party_popularity@neutrality }
	set_variable = { save_communism = party_popularity@communism }
	set_variable = { save_democratic_liberalism = party_popularity@democratic_liberalism }
	set_variable = { save_ultranationalism = party_popularity@ultranationalism }
	set_variable = { save_authoritarian_democratic = party_popularity@authoritarian_democratic }
	set_variable = { save_democratic_communism = party_popularity@democratic_communism }
	set_variable = { save_socialism_democratic = party_popularity@socialism_democratic }

	multiply_variable = { save_democratic = 100 }
	multiply_variable = { save_fascism = 100 }
	multiply_variable = { save_neutrality = 100 }
	multiply_variable = { save_communism = 100 }
	multiply_variable = { save_democratic_liberalism = 100 }
	multiply_variable = { save_ultranationalism = 100 }
	multiply_variable = { save_authoritarian_democratic = 100 }
	multiply_variable = { save_democratic_communism = 100 }
	multiply_variable = { save_socialism_democratic = 100 }

	puppet_saving_flag_checker = yes

	set_temp_variable = { total_ideology_score = 100 }
	subtract_from_temp_variable = { total_ideology_score = save_democratic }
	subtract_from_temp_variable = { total_ideology_score = save_fascism }
	subtract_from_temp_variable = { total_ideology_score = save_neutrality }
	subtract_from_temp_variable = { total_ideology_score = save_communism }
	subtract_from_temp_variable = { total_ideology_score = save_democratic_liberalism }
	subtract_from_temp_variable = { total_ideology_score = save_ultranationalism }
	subtract_from_temp_variable = { total_ideology_score = save_authoritarian_democratic }
	subtract_from_temp_variable = { total_ideology_score = save_democratic_communism }
	subtract_from_temp_variable = { total_ideology_score = save_socialism_democratic }

	if = {
		limit = { NOT = { check_variable = { total_ideology_score = 0 } } }
		if = {
			limit = { has_government = democratic }
			add_to_variable = { save_democratic = total_ideology_score }
		}
		else_if = {
			limit = { has_government = fascism }
			add_to_variable = { save_fascism = total_ideology_score }
		}
		else_if = {
			limit = { has_government = communism }
			add_to_variable = { save_communism = total_ideology_score }
		}
		else_if = {
			limit = { has_government = democratic_communism }
			add_to_variable = { save_democratic_communism = total_ideology_score }
		}
		else_if = {
			limit = { has_government = democratic_liberalism }
			add_to_variable = { save_democratic_communism = total_ideology_score }
		}
		else_if = {
			limit = { has_government = ultranationalism }
			add_to_variable = { save_democratic_communism = total_ideology_score }
		}
		else_if = {
			limit = { has_government = authoritarian_democratic }
			add_to_variable = { save_democratic_communism = total_ideology_score }
		}
		else_if = {
			limit = { has_government = socialism_democratic }
			add_to_variable = { save_democratic_communism = total_ideology_score }
		}
		else = {
			limit = { has_government = neutrality }
			add_to_variable = { save_neutrality = total_ideology_score }
		}
	}

	
}

d_check_thing2 = {
	if = {
		limit = {
			has_country_flag = was_neutrality
		}
		log = "romania"
	}
}

reset_government = {
	set_popularities = {
		fascism = save_fascism
		communism = save_communism
		neutrality = save_neutrality
		democratic = save_democratic
		democratic_liberalism = save_democratic_liberalism
		socialism_democratic = save_socialism_democratic
		democratic_communism = save_democratic_communism
		authoritarian_democratic = save_authoritarian_democratic
		ultranationalism = save_ultranationalism
	}
	if = {
		limit = { has_country_flag = was_democratic }
		set_politics = { ruling_party = democratic }
	}
	if = {
		limit = { has_country_flag = was_fascism }
		set_politics = { ruling_party = fascism }
	}
	if = {
		limit = { has_country_flag = was_communism }
		set_politics = { ruling_party = communism }
	}
	if = {
		limit = { has_country_flag = was_democratic_liberalism }
		set_politics = { ruling_party = democratic_liberalism }
	}
	if = {
		limit = { has_country_flag = was_socialism_democratic }
		set_politics = { ruling_party = socialism_democratic }
	}
	if = {
		limit = { has_country_flag = was_ultranationalism }
		set_politics = { ruling_party = ultranationalism }
	}
	if = {
		limit = { has_country_flag = was_democratic }
		set_politics = { ruling_party = democratic }
	}
	if = {
		limit = { has_country_flag = was_neutrality }
		set_politics = { ruling_party = neutrality }
		log = "Romania: [THIS.GetName]"
	}
	if = {
		limit = { has_country_flag = was_authoritarian_democratic }
		set_politics = { ruling_party = authoritarian_democratic }
	}

	clear_variable = save_fascism
	clear_variable = save_democratic
	clear_variable = save_neutrality
	clear_variable = save_communism
	clear_variable = save_democratic_liberalism
	clear_variable = save_socialism_democratic
	clear_variable = save_democratic_communism
	clear_variable = save_authoritarian_democratic
	clear_variable = save_ultranationalism
}

puppet_saving_flag_checker = {
	if = {
		limit = { has_government = democratic }
		set_country_flag = { flag = was_democratic value = 1 days = 2 }
	}
	if = {
		limit = { has_government = fascism }
		set_country_flag = { flag = was_fascism value = 1 days = 2 }
	}
	if = {
		limit = { has_government = communism }
		set_country_flag = { flag = was_communism value = 1 days = 2 }
	}
	if = {
		limit = { has_government = democratic_liberalism }
		set_country_flag = { flag = was_democratic_liberalism value = 1 days = 2 }
	}
	if = {
		limit = { has_government = socialism_democratic }
		log = "hi"
		set_country_flag = { flag = was_socialism_democratic value = 1 days = 2 }
	}
	if = {
		limit = { has_government = ultranationalism }
		set_country_flag = { flag = was_ultranationalism value = 1 days = 2 }
	}
	if = {
		limit = { has_government = democratic_communism }
		set_country_flag = { flag = was_democratic_communism value = 1 days = 2 }
	}
	if = {
		limit = { has_government = neutrality }
		set_country_flag = { flag = was_neutrality value = 1 days = 2 }
	}
	if = {
		limit = { has_government = authoritarian_democratic }
		set_country_flag = { flag = was_authoritarian_democratic value = 1 days = 2 }
	}
}

d_show_flag_icons = {
	set_country_flag = show_flag_map_icons
} 
d_clear_flag_icons = {
	clr_country_flag = show_flag_map_icons
}

more_mapmodes_update_custom_map_modes_effects = {
	force_update_map_mode = {
		mapmode = more_mapmodes_core_map_mode
	}
	force_update_map_mode = {
		mapmode = more_mapmodes_majors_map_mode
	}
	force_update_map_mode = {
		mapmode = more_mapmodes_world_war_map_mode
	}
	force_update_map_mode = {
		mapmode = more_mapmodes_global_influence_map_mode
	}
}

d_indian_war_setup = {
	AIG = {
		create_faction = "Bihrani Pact"
		add_to_faction = DRA
	}
}

replace_civ_with_arms_factories = {	

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
	
	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}

	random_owned_controlled_state = {
		limit = {
			is_fully_controlled_by = ROOT
			industrial_complex > 0
		}
		remove_building = {
			type = industrial_complex
			level = 1
		}
		add_building_construction = {
			type = arms_factory
			level = 1
			instant_build = yes
		}
	}
}

#Country scope
ROOT_inherit_current_scope_wars_effect = {
	custom_effect_tooltip = ROOT_inherit_current_scope_wars_effect
	hidden_effect = {	
		every_country = {
			limit = {
				has_defensive_war_with = PREV
			}
			ROOT = { declare_war_on = { target = PREV type = annex_everything } }
		}
		every_country = {
			limit = {
				has_offensive_war_with = PREV
			}
			declare_war_on = { target = ROOT type = annex_everything }
		}
	}
}

# Add AI strategies in case of Central European Alliance
GER_democratic_nations_ai_strategies = {
	# Reduce Contain against SOV
	add_ai_strategy = {
		type = contain
		id = "SOV"
		value = -800
	}
	add_ai_strategy = {
		type = contain
		id = "ITA"
		value = -800
	}
	# Poland
	add_ai_strategy = {
		type = protect
		id = "POL"
		value = -200
	}
	add_ai_strategy = {
		type = ignore
		id = "POL"
		value = 200
	}
	add_ai_strategy = {
		type = befriend
		id = "POL"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "POL"
		value = -200
	}
	# Finland
	add_ai_strategy = {
		type = protect
		id = "FIN"
		value = -200
	}
	add_ai_strategy = {
		type = ignore
		id = "FIN"
		value = 200
	}
	add_ai_strategy = {
		type = befriend
		id = "FIN"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "FIN"
		value = -200
	}
	# Estonia
	add_ai_strategy = {
		type = protect
		id = "EST"
		value = -200
	}
	add_ai_strategy = {
		type = ignore
		id = "EST"
		value = 200
	}
	add_ai_strategy = {
		type = befriend
		id = "EST"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "EST"
		value = -200
	}
	# Latvia
	add_ai_strategy = {
		type = protect
		id = "LAT"
		value = -200
	}
	add_ai_strategy = {
		type = ignore
		id = "LAT"
		value = 200
	}
	add_ai_strategy = {
		type = befriend
		id = "LAT"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "LAT"
		value = -200
	}
	# Lithuania
	add_ai_strategy = {
		type = protect
		id = "LIT"
		value = -200
	}
	add_ai_strategy = {
		type = ignore
		id = "LIT"
		value = 200
	}
	add_ai_strategy = {
		type = befriend
		id = "LIT"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "LIT"
		value = -200
	}
	# Romania
	add_ai_strategy = {
		type = protect
		id = "ROM"
		value = -200
	}
	add_ai_strategy = {
		type = ignore
		id = "ROM"
		value = 200
	}
	add_ai_strategy = {
		type = befriend
		id = "ROM"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "ROM"
		value = -200
	}
	# Norway
	add_ai_strategy = {
		type = ignore
		id = "NOR"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "NOR"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "NOR"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "NOR"
		value = -200
	}
	# Sweden
	add_ai_strategy = {
		type = ignore
		id = "SWE"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "SWE"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "SWE"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "SWE"
		value = -200
	}
	# Denmark
	add_ai_strategy = {
		type = ignore
		id = "DEN"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "DEN"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "DEN"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "DEN"
		value = -200
	}
	# Netherlands
	add_ai_strategy = {
		type = ignore
		id = "HOL"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "HOL"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "HOL"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "HOL"
		value = -200
	}
	# Belgium
	add_ai_strategy = {
		type = ignore
		id = "BEL"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "BEL"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "BEL"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "BEL"
		value = -200
	}
	# Luxemburg
	add_ai_strategy = {
		type = ignore
		id = "LUX"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "LUX"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "LUX"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "LUX"
		value = -200
	}
	# Austria
	add_ai_strategy = {
		type = ignore
		id = "AUS"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "AUS"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "AUS"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "AUS"
		value = -200
	}
	# Hungary
	add_ai_strategy = {
		type = ignore
		id = "HUN"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "HUN"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "HUN"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "HUN"
		value = -200
	}
	# Czechoslovakia
	add_ai_strategy = {
		type = ignore
		id = "CZE"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "CZE"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "CZE"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "CZE"
		value = -200
	}
	# Yugoslavia
	add_ai_strategy = {
		type = ignore
		id = "YUG"
		value = 200
	}
	add_ai_strategy = {
		type = protect
		id = "YUG"
		value = -200
	}
	add_ai_strategy = {
		type = befriend
		id = "YUG"
		value = -200
	}
	add_ai_strategy = {
		type = alliance
		id = "YUG"
		value = -200
	}
}

print_variable_log_effect = {
	print_variables = {
		file = variables_yug
		append = yes
	}
}

get_best_alliance_match_democratic_effect = { #arguably a trigger, but it does stuff so we keep it in here. If this is your first time seeing this, welcome to my personal hell.
	if = {
		limit = {
			any_other_country = {
				is_faction_leader = yes
				is_major = yes
				has_government = democratic
				not = { has_war_with = ROOT }
				set_temp_variable = { ROOT.best_leader = this }
				set_temp_variable = { ROOT.best_leader_score = 0 }
			}
		}
	}
	if = {
		limit = {
			all_other_country = {
				is_faction_leader = yes
				is_major = yes
				has_government = democratic
				not = { has_war_with = ROOT }
				set_temp_variable = { this.leader_score = num_of_factories }
				add_to_temp_variable = { this.leader_score = num_battalions }
				all_of_scopes = {
					array = allies
					add_to_temp_variable = { PREV.leader_score = num_of_factories }
					add_to_temp_variable = { PREV.leader_score = num_battalions }
				}
				if = {
					limit = {
						capital_scope = {
							is_on_continent = ROOT
						}
					}
					multiply_temp_variable = { leader_score = 2 }
				}
				if = {
					limit = {
						any_neighbor_country = { tag = ROOT }
					}
					multiply_temp_variable = { leader_score = 1.25 }
				}
				if = {
					limit = {
						check_variable = { ROOT.best_leader_score < leader_score }
						set_temp_variable = { ROOT.best_leader = this }
						set_temp_variable = { ROOT.best_leader_score = leader_score }
					}
				}
			}
		}
	}		
}

get_best_alliance_match_fascism_effect = { #arguably a trigger, but it does stuff so we keep it in here. If this is your first time seeing this, welcome to my personal hell.
	if = {
		limit = {
			any_other_country = {
				is_faction_leader = yes
				is_major = yes
				has_government = fascism
				not = { has_war_with = ROOT }
				set_temp_variable = { ROOT.best_leader = this }
				set_temp_variable = { ROOT.best_leader_score = 0 }
			}
		}
	}
	if = {
		limit = {
			all_other_country = {
				
				is_faction_leader = yes
				is_major = yes
				has_government = fascism
				not = { has_war_with = ROOT }
				
				set_temp_variable = { this.leader_score = num_of_factories }
				add_to_temp_variable = { this.leader_score = num_battalions }
				all_of_scopes = {
					array = allies
					add_to_temp_variable = { PREV.leader_score = num_of_factories }
					add_to_temp_variable = { PREV.leader_score = num_battalions }
				}
				if = {
					limit = {
						capital_scope = {
							is_on_continent = ROOT
						}
					}
					multiply_temp_variable = { this.leader_score = 2 }
				}
				if = {
					limit = {
						any_neighbor_country = { tag = ROOT }
					}
					multiply_temp_variable = { this.leader_score = 1.25 }
				}
				if = {
					limit = {
						check_variable = { ROOT.best_leader_score < this.leader_score }
					}
					set_temp_variable = { ROOT.best_leader = this }
					set_temp_variable = { ROOT.best_leader_score = this.leader_score }
				}
			}
		}
	}		
}

get_best_alliance_match_communism_effect = { #arguably a trigger, but it does stuff so we keep it in here. If this is your first time seeing this, welcome to my personal hell.
	if = {
		limit = {
			any_other_country = {
				is_faction_leader = yes
				is_major = yes
				has_government = communism
				not = { has_war_with = ROOT }
				set_temp_variable = { ROOT.best_leader = this }
				set_temp_variable = { ROOT.best_leader_score = 0 }
			}
		}
	}
	if = {
		limit = {
			all_other_country = {
				is_faction_leader = yes
				is_major = yes
				has_government = communism
				not = { has_war_with = ROOT }
				set_temp_variable = { this.leader_score = num_of_factories }
				add_to_temp_variable = { this.leader_score = num_battalions }
				all_of_scopes = {
					array = allies
					add_to_temp_variable = { PREV.leader_score = num_of_factories }
					add_to_temp_variable = { PREV.leader_score = num_battalions }
				}
				if = {
					limit = {
						capital_scope = {
							is_on_continent = ROOT
						}
					}
					multiply_temp_variable = { leader_score = 2 }
				}
				if = {
					limit = {
						any_neighbor_country = { tag = ROOT }
					}
					multiply_temp_variable = { leader_score = 1.25 }
				}
				if = {
					limit = {
						check_variable = { ROOT.best_leader_score < leader_score }
						set_temp_variable = { ROOT.best_leader = this }
						set_temp_variable = { ROOT.best_leader_score = leader_score }
					}
				}
			}
		}
	}		
}



civil_war_anti_exploiter_punitive_action = {
	# Anti-exploiter punitive brigades! BET YA DIDN'T SEE THAT COMING DID YA?!
	if = {
		limit = {
			has_army_size = {
			    size < 1
			}
		}
		division_template = {
			name = "Anti-Exploit Punitive Brigade"
			priority = 1
			division_names_group = ENG_MAR_01
			is_locked = yes
			regiments = {
				infantry = { x = 0 y = 0 }
				infantry = { x = 0 y = 1 }
				infantry = { x = 0 y = 2 }
	
		   	   	infantry = { x = 1 y = 0 }
				infantry = { x = 1 y = 1 }
				infantry = { x = 1 y = 2 }
	
		   	   	infantry = { x = 2 y = 0 }
				artillery_brigade = { x = 2 y = 1 }
				artillery_brigade = { x = 2 y = 2 }
			}
			support = {
				engineer = { x = 0 y = 0 }
				recon = { x = 0 y = 1 }
				artillery = { x = 0 y = 2 }
			}
		}
		random_state = {
			limit = {
				is_capital = yes
				is_fully_controlled_by = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
		}
		random_state = {
			limit = {
				is_in_home_area = yes
				is_fully_controlled_by = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
		}
		random_state = {
			limit = {
				is_in_home_area = yes
				is_fully_controlled_by = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
		}
		random_state = {
			limit = {
				is_in_home_area = yes
				is_fully_controlled_by = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
		}
		random_state = {
			limit = {
				is_in_home_area = yes
				is_fully_controlled_by = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
			create_unit = {
				division = "division_template = \"Anti-Exploit Punitive Brigade\" start_experience_factor = 1 start_equipment_factor = 1"
				owner = PREV
			}
		}
	}
}

clear_sabotaged_resources_if_necesary = {
	if = {
		limit = {
			not = {
				has_dynamic_modifier = {
					modifier = sabotaged_resources
				}
			}
		}
		
		clear_variable = sabotaged_oil
		clear_variable = sabotaged_aluminium
		clear_variable = sabotaged_rubber
		clear_variable = sabotaged_tungsten
		clear_variable = sabotaged_steel
		clear_variable = sabotaged_chromium
	}
}

remove_from_allowed_party = {
	if = {
		limit = { has_government = democratic }
		set_temp_variable = { allowed_party_democratic = 0 }
	}
	else_if = {
		limit = { has_government = fascism }
		set_temp_variable = { allowed_party_fascism = 0 }
	}
	else_if = {
		limit = { has_government = communism }
		set_temp_variable = { allowed_party_communism = 0 }
	}
	else_if = {
		limit = { has_government = neutrality }
		set_temp_variable = { allowed_party_neutrality = 0 }
	}
}

#expectes a temp variable country_to_initiate which should contain original_tag to instantiate as a collabration government
instantiate_collaboration_government = {
	custom_effect_tooltip = compliance_80_effect_tooltip
	hidden_effect = {
		set_variable = { collaboration_formed@var:country_to_initiate = 1 }
		
		if = {
			# if country_to_initiate does not exist, simply release it as a puppet
			limit = { 
				var:country_to_initiate = {
					exists = no
				}
			}
			var:country_to_initiate = { set_variable = { collaboration_formed_by = PREV } }
			release_autonomy = {
				target = country_to_initiate
				autonomy_state = autonomy_collaboration_government
				freedom_level = 0.5
				release_non_owned_controlled = yes
			}
		}
		else = {
			# if country_to_initiate exists, create a dynamic country as our new puppet
			
			create_dynamic_country = {
				original_tag = country_to_initiate
			
				set_variable = { collaboration_formed_by = PREV }
				set_temp_variable = { new_country = this }
				
				PREV = {
					every_controlled_state = {
						limit = { occupied_country_tag = country_to_initiate }
						
						var:new_country = {
							transfer_state = PREV
						}
					}
					
					puppet = new_country
					
					set_autonomy = {
						target = new_country
						autonomy_state = autonomy_collaboration_government
						freedom_level = 0.5
					}
				}
			}
		}
	}
}

abandon_colony_tag = {
	if = {
		limit = {
			is_subject = yes
		}
		if = {
			limit = {
				original_tag = CAN
			}
			if = { 
				limit = { NOT = { has_dlc = "Together for Victory" } }
				set_cosmetic_tag = CAN_ALY
			}
			else = {
				set_cosmetic_tag = CAN_UK
			}
		}
		else_if = {
			limit = {
				original_tag = RAJ
			}
			set_cosmetic_tag = RAJ_UK
		}
		else_if = {
			limit = {
				original_tag = MAL
			}
			set_cosmetic_tag = MAL_UK
		}
		else_if = {
			limit = {
				original_tag = INS
			}
			set_cosmetic_tag = INS_HOL
		}
	}
	else = {
		if = {
			limit = {
				OR = {
					has_cosmetic_tag = united_polynesia
					has_cosmetic_tag = MAJ_UNIFIED
				}
			}
		}
		else = {
			drop_cosmetic_tag = yes
		}
	}
}







on_daily = {

}

#on_daily_USA = {
#	# you can specify an on daily action for a specific country
#}